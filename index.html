<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üõí Sistema de Vendas - Armarinho</title>
<script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
<style>
:root { --primary: #3498db; --success: #2ecc71; --danger: #e74c3c; --warning: #f39c12; --dark: #2c3e50; --light: #ecf0f1; --backup: #9b59b6; --barcode: #9b59b6; }
* { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
body { background: #f5f7fa; color: #333; height: 100vh; overflow: hidden; }
.header { background: var(--dark); color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: relative; z-index: 100; }
.logo { font-size: 24px; font-weight: bold; display: flex; align-items: center; gap: 10px; }
.container { display: flex; height: calc(100vh - 70px); }
.sidebar { width: 350px; background: white; border-right: 1px solid #ddd; padding: 20px; overflow-y: auto; }
.search-box { margin-bottom: 20px; position: relative; }
.search-box input { width: 100%; padding: 14px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; }
.search-box input:focus { border-color: var(--primary); outline: none; }
.products-list { max-height: 300px; overflow-y: auto; margin-bottom: 20px; }
.product-item { padding: 12px; border-bottom: 1px solid #eee; cursor: pointer; transition: background 0.2s; }
.product-item:hover { background: #f8f9fa; }
.product-item .name { font-weight: 500; }
.product-item .price { color: var(--primary); font-weight: bold; margin-top: 4px; }
.cart { flex: 1; display: flex; flex-direction: column; background: #f8f9fa; padding: 20px; }
.cart-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
.cart-title { font-size: 24px; font-weight: bold; color: var(--dark); }
.cart-items { background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); flex: 1; overflow-y: auto; }
.cart-item { padding: 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; }
.cart-item:last-child { border-bottom: none; }
.cart-item .desc { flex: 2; }
.cart-item .qty { flex: 1; text-align: center; color: #7f8c8d; }
.cart-item .price { flex: 1; text-align: right; font-weight: bold; }
.cart-total { background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); padding: 20px; margin-top: 20px; }
.total-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 18px; }
.total-row.final { font-size: 24px; font-weight: bold; color: var(--primary); margin-top: 15px; padding-top: 15px; border-top: 2px solid #eee; }
.actions { display: flex; gap: 15px; margin-top: 25px; }
.btn { padding: 15px 25px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
.btn-primary { background: var(--primary); color: white; flex: 1; }
.btn-primary:hover { background: #2980b9; }
.btn-danger { background: var(--danger); color: white; }
.btn-danger:hover { background: #c0392b; }
.btn-warning { background: var(--warning); color: white; }
.btn-warning:hover { background: #e67e22; }
.btn-backup { background: var(--backup); color: white; }
.btn-backup:hover { background: #8e44ad; }
.btn-barcode-modal { background: var(--barcode); color: white; border: none; padding: 12px 25px; border-radius: 12px; font-weight: bold; font-size: 16px; cursor: pointer; display: flex; align-items: center; gap: 10px; margin: 15px 0; box-shadow: 0 4px 10px rgba(155, 89, 182, 0.4); width: 100%; }
.btn-barcode-modal:hover { background: #8e44ad; transform: translateY(-2px); }
.login-container { background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); padding: 40px; width: 100%; max-width: 400px; text-align: center; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
.login-title { color: var(--dark); margin-bottom: 30px; font-size: 28px; display: flex; justify-content: center; align-items: center; gap: 10px; }
.login-title i { font-size: 32px; }
.error { color: var(--danger); background: #fadbd8; padding: 12px; border-radius: 8px; margin-bottom: 20px; display: none; }
.user-select { width: 100%; padding: 14px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; background: white; cursor: pointer; margin-bottom: 15px; }
.user-select:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2); }
#scanner-modal {
display: none;
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0,0,0,0.95);
z-index: 9999;
justify-content: center;
align-items: center;
flex-direction: column;
padding: 20px;
}
#scanner-modal.active {
display: flex;
}
#reader {
width: 100%;
max-width: 400px;
margin-bottom: 20px;
background: white;
border-radius: 15px;
padding: 15px;
box-shadow: 0 10px 30px rgba(0,0,0,0.5);
}
.scanner-header {
background: #2c3e50;
color: white;
padding: 15px;
border-radius: 12px 12px 0 0;
text-align: center;
margin-bottom: 15px;
font-weight: bold;
font-size: 18px;
}
.scanner-close-btn {
background: #dc2626;
color: white;
border: none;
padding: 12px 30px;
border-radius: 12px;
font-weight: bold;
font-size: 16px;
cursor: pointer;
margin-top: 10px;
box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}
.scanner-close-btn:hover {
background: #b91c1c;
transform: translateY(-2px);
}
.empty-cart { padding: 30px; text-align: center; color: #999; }
.notification {
position: fixed;
top: 20px;
right: 20px;
background: white;
padding: 15px 25px;
border-radius: 8px;
box-shadow: 0 5px 15px rgba(0,0,0,0.3);
z-index: 9999;
display: flex;
align-items: center;
gap: 10px;
border-left: 4px solid var(--success);
}
.notification.error { border-left-color: var(--danger); }
.notification i { font-size: 20px; }
.barcode-reader {
background: #f8f9fa;
padding: 15px;
border-radius: 8px;
margin-bottom: 15px;
border: 2px dashed var(--barcode);
}
.barcode-reader .label {
font-weight: bold;
color: var(--barcode);
margin-bottom: 10px;
display: block;
text-align: center;
}
.barcode-reader input {
width: 100%;
padding: 12px;
border: 2px solid var(--barcode);
border-radius: 6px;
font-size: 18px;
text-align: center;
font-weight: bold;
}
.status-bar {
background: #2c3e50;
color: white;
padding: 8px 20px;
font-size: 14px;
text-align: center;
position: absolute;
bottom: 0;
left: 0;
right: 0;
z-index: 1000;
}
</style>
</head>
<body>
<!-- Tela de Login -->
<div id="screen-login" class="screen" style="height:100vh; background: linear-gradient(135deg, #1a2a6c, #2c3e50); display:flex; align-items:center; justify-content:center;">
<div class="login-container">
<div class="login-title">
<i>üõí</i> Sistema de Vendas
</div>
<div id="error-login" class="error"></div>
<div class="form-group">
<label for="login-user" style="color:white; margin-bottom:8px; display:block;">üë§ Selecione o Usu√°rio</label>
<select id="login-user" class="user-select">
<option value="">----------</option>
<option value="admin">üëë Administrador</option>
<option value="operador">üë§ Operador</option>
</select>
</div>
<div class="form-group">
<label for="login-pass" style="color:white; margin-bottom:8px; display:block;">üîë Senha</label>
<input type="password" id="login-pass" placeholder="Digite sua senha" style="width:100%; padding:12px; border-radius:6px; border:1px solid #ddd;">
</div>
<button class="btn btn-primary" id="btn-login" style="width:100%; margin-top:20px;">üîê Entrar</button>
<div style="margin-top:25px; color:#9b59b6; font-size:14px;">
üîê Admin: java1814 | üë§ Operador: operador123
</div>
</div>
</div>
<!-- Tela Principal (Vendas) -->
<div id="screen-vendas" class="screen" style="display:none;">
<div class="header">
<div class="logo">
<i>üõí</i> Armarinho - <span id="user-name">Operador</span>
</div>
<button class="btn btn-danger" id="btn-logout" style="padding:8px 15px; font-size:14px;">Sair</button>
</div>
<div class="container">
<div class="sidebar">
<!-- Bot√£o Scanner de C√¢mera -->
<button class="btn-barcode-modal" onclick="abrirScanner()">
üì∑ üì± Ler C√≥digo com C√¢mera
</button>
<!-- Leitor de C√≥digo de Barras -->
<div class="barcode-reader">
<span class="label">üì± Leitor de C√≥digo de Barras</span>
<input type="text" id="barcode-input" placeholder="Escaneie ou digite o c√≥digo..." autocomplete="off">
</div>
<div class="search-box">
<input type="text" id="busca-produto" placeholder="Buscar produto...">
</div>
<div class="products-list" id="lista-produtos">
<!-- Produtos ser√£o carregados aqui -->
</div>
</div>
<div class="cart">
<div class="cart-header">
<div class="cart-title">Carrinho</div>
<div id="cart-count">0 itens</div>
</div>
<div class="cart-items" id="itens-carrinho">
<div class="empty-cart">Carrinho vazio. Adicione produtos para iniciar a venda.</div>
</div>
<div class="cart-total">
<div class="total-row">
<span>Subtotal:</span>
<span id="subtotal">R$ 0,00</span>
</div>
<div class="total-row final">
<span>Total:</span>
<span id="total">R$ 0,00</span>
</div>
</div>
<div class="actions">
<button class="btn btn-danger" id="btn-cancelar">‚ùå Cancelar Venda</button>
<button class="btn btn-primary" id="btn-finalizar">‚úÖ Finalizar Venda</button>
</div>
</div>
</div>
<div class="status-bar">
Sistema de Vendas - Armarinho | ‚úÖ Online
</div>
</div>
<!-- Modal Scanner de C√¢mera -->
<div id="scanner-modal">
<div class="scanner-header">
üì± Aponte a c√¢mera para o c√≥digo de barras
</div>
<div id="reader"></div>
<button class="scanner-close-btn" onclick="fecharScanner()">‚ùå Fechar Scanner</button>
</div>
<!-- Notifications -->
<div id="notification-container" style="position:fixed; top:20px; right:20px; z-index:9999;"></div>
<script>
// ========== DADOS INICIAIS ==========
function inicializarDados() {
if (!localStorage.getItem('vendas_db')) {
const dbInicial = {
usuarios: [
{ id: 1, nome: 'Administrador', login: 'admin', senha: 'java1814', perfil: 'admin' },
{ id: 2, nome: 'Operador', login: 'operador', senha: 'operador123', perfil: 'operador' }
],
produtos: [
{ id: 1, codigo: '001', codigo_barra: '7891234567890', descricao: 'Bot√£o de Madeira', preco_venda: 5.00, estoque: 120, ativo: true },
{ id: 2, codigo: '002', codigo_barra: '7891234567891', descricao: 'Linha de Algod√£o', preco_venda: 8.50, estoque: 85, ativo: true },
{ id: 3, codigo: '003', codigo_barra: '7891234567892', descricao: 'Agulha de Costura', preco_venda: 3.20, estoque: 200, ativo: true },
{ id: 4, codigo: '004', codigo_barra: '7891234567893', descricao: 'Fita M√©trica', preco_venda: 12.00, estoque: 50, ativo: true },
{ id: 5, codigo: '005', codigo_barra: '7891234567894', descricao: 'Tesoura Profissional', preco_venda: 25.00, estoque: 30, ativo: true },
{ id: 6, codigo: '006', codigo_barra: '7891234567895', descricao: 'Zipper 20cm', preco_venda: 4.80, estoque: 150, ativo: true },
{ id: 7, codigo: '007', codigo_barra: '7891234567896', descricao: 'El√°stico 1m', preco_venda: 2.50, estoque: 200, ativo: true },
{ id: 8, codigo: '008', codigo_barra: '7891234567897', descricao: 'Vi√©s Estampado', preco_venda: 6.90, estoque: 75, ativo: true }
]
};
localStorage.setItem('vendas_db', JSON.stringify(dbInicial));
}
}
// ========== FUN√á√ïES AUXILIARES ==========
function formatarMoeda(valor) {
return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(valor);
}
function buscarDados() {
return JSON.parse(localStorage.getItem('vendas_db'));
}
function mostrarNotificacao(mensagem, tipo = 'success') {
const container = document.getElementById('notification-container');
const notificacao = document.createElement('div');
notificacao.className = `notification ${tipo === 'error' ? 'error' : ''}`;
notificacao.innerHTML = `<i>${tipo === 'success' ? '‚úÖ' : '‚ùå'}</i> <span>${mensagem}</span>`;
container.appendChild(notificacao);
setTimeout(() => {
notificacao.remove();
}, 3000);
}
// ========== LOGIN ==========
document.getElementById('btn-login').addEventListener('click', () => {
const usuario = document.getElementById('login-user').value;
const senha = document.getElementById('login-pass').value;
const errorDiv = document.getElementById('error-login');
if (!usuario) {
errorDiv.textContent = '‚ö†Ô∏è Selecione um usu√°rio!';
errorDiv.style.display = 'block';
return;
}
if (!senha) {
errorDiv.textContent = '‚ö†Ô∏è Digite a senha!';
errorDiv.style.display = 'block';
return;
}
const db = buscarDados();
const user = db.usuarios.find(u => u.login === usuario && u.senha === senha);
if (user) {
sessionStorage.setItem('user_id', user.id);
sessionStorage.setItem('user_perfil', user.perfil);
sessionStorage.setItem('user_nome', user.nome);
document.getElementById('user-name').textContent = user.nome;
document.getElementById('screen-login').style.display = 'none';
document.getElementById('screen-vendas').style.display = 'block';
carregarProdutos();
errorDiv.style.display = 'none';
} else {
errorDiv.textContent = '‚ùå Senha incorreta!';
errorDiv.style.display = 'block';
}
});
document.getElementById('login-pass').addEventListener('keypress', (e) => {
if (e.key === 'Enter') document.getElementById('btn-login').click();
});
document.getElementById('login-user').addEventListener('change', () => {
document.getElementById('login-pass').focus();
});
document.getElementById('btn-logout').addEventListener('click', () => {
sessionStorage.clear();
document.getElementById('screen-vendas').style.display = 'none';
document.getElementById('screen-login').style.display = 'block';
document.getElementById('login-user').value = '';
document.getElementById('login-pass').value = '';
document.getElementById('error-login').style.display = 'none';
limparCarrinho();
});
// ========== PRODUTOS ==========
function carregarProdutos() {
const db = buscarDados();
const lista = document.getElementById('lista-produtos');
lista.innerHTML = '';
db.produtos.filter(p => p.ativo !== false).forEach(p => {
const div = document.createElement('div');
div.className = 'product-item';
div.innerHTML = `<div class="name">${p.descricao}</div><div class="price">${formatarMoeda(p.preco_venda)}</div>`;
div.addEventListener('click', () => adicionarAoCarrinho(p));
lista.appendChild(div);
});
// Busca por teclado
document.getElementById('busca-produto').addEventListener('input', (e) => {
const termo = e.target.value.toLowerCase();
lista.innerHTML = '';
db.produtos.filter(p => p.ativo !== false && p.descricao.toLowerCase().includes(termo)).forEach(p => {
const div = document.createElement('div');
div.className = 'product-item';
div.innerHTML = `<div class="name">${p.descricao}</div><div class="price">${formatarMoeda(p.preco_venda)}</div>`;
div.addEventListener('click', () => adicionarAoCarrinho(p));
lista.appendChild(div);
});
});
}
// ========== CARRINHO ==========
let carrinho = [];
function atualizarCarrinho() {
const container = document.getElementById('itens-carrinho');
const countEl = document.getElementById('cart-count');
const subtotalEl = document.getElementById('subtotal');
const totalEl = document.getElementById('total');
if (carrinho.length === 0) {
container.innerHTML = '<div class="empty-cart">Carrinho vazio. Adicione produtos para iniciar a venda.</div>';
countEl.textContent = '0 itens';
subtotalEl.textContent = 'R$ 0,00';
totalEl.textContent = 'R$ 0,00';
return;
}
let html = '';
let subtotal = 0;
carrinho.forEach(item => {
const totalItem = item.quantidade * item.preco;
subtotal += totalItem;
html += `<div class="cart-item"><div class="desc">${item.descricao}</div><div class="qty">${item.quantidade}x</div><div class="price">${formatarMoeda(item.preco)}</div></div>`;
});
container.innerHTML = html;
countEl.textContent = `${carrinho.length} itens`;
subtotalEl.textContent = formatarMoeda(subtotal);
totalEl.textContent = formatarMoeda(subtotal);
}
function adicionarAoCarrinho(produto) {
const existente = carrinho.find(i => i.produto_id === produto.id);
if (existente) {
existente.quantidade += 1;
} else {
carrinho.push({
produto_id: produto.id,
descricao: produto.descricao,
quantidade: 1,
preco: produto.preco_venda
});
}
atualizarCarrinho();
mostrarNotificacao(`‚úÖ ${produto.descricao} adicionado!`, 'success');
document.getElementById('busca-produto').value = '';
document.getElementById('barcode-input').value = '';
}
function limparCarrinho() {
carrinho = [];
atualizarCarrinho();
}
document.getElementById('btn-cancelar').addEventListener('click', () => {
limparCarrinho();
mostrarNotificacao('üõí Venda cancelada!', 'success');
});
document.getElementById('btn-finalizar').addEventListener('click', () => {
if (carrinho.length === 0) {
mostrarNotificacao('‚ö†Ô∏è Carrinho vazio!', 'error');
return;
}
const total = carrinho.reduce((sum, item) => sum + (item.quantidade * item.preco), 0);
mostrarNotificacao(`‚úÖ Venda finalizada! Total: ${formatarMoeda(total)}`, 'success');
limparCarrinho();
});
// ========== LEITOR DE C√ìDIGO DE BARRAS ==========
document.getElementById('barcode-input').addEventListener('keypress', (e) => {
if (e.key === 'Enter') {
e.preventDefault();
const codigo = document.getElementById('barcode-input').value.trim();
if (codigo) {
const db = buscarDados();
const produto = db.produtos.find(p => 
(p.codigo_barra && p.codigo_barra === codigo) || 
(p.codigo && p.codigo === codigo) ||
p.descricao.toLowerCase().includes(codigo.toLowerCase())
);
if (produto && produto.ativo !== false) {
adicionarAoCarrinho(produto);
} else {
mostrarNotificacao('‚ùå Produto n√£o encontrado!', 'error');
}
document.getElementById('barcode-input').value = '';
}
}
});
// ========== SCANNER DE C√ÇMERA ==========
let html5QrcodeScanner = null;
function abrirScanner() {
document.getElementById('scanner-modal').classList.add('active');
html5QrcodeScanner = new Html5Qrcode("reader");
html5QrcodeScanner.start(
{ facingMode: "environment" },
{ fps: 10, qrbox: { width: 250, height: 250 } },
(decodedText) => {
html5QrcodeScanner.stop().then(() => {
document.getElementById('scanner-modal').classList.remove('active');
const db = buscarDados();
const produto = db.produtos.find(p => 
(p.codigo_barra && p.codigo_barra === decodedText.trim()) || 
(p.codigo && p.codigo === decodedText.trim()) ||
p.descricao.toLowerCase().includes(decodedText.trim().toLowerCase())
);
if (produto && produto.ativo !== false) {
adicionarAoCarrinho(produto);
mostrarNotificacao(`‚úÖ ${produto.descricao} adicionado!`, 'success');
} else {
mostrarNotificacao('‚ùå Produto n√£o encontrado!', 'error');
}
}).catch(err => console.error("Erro ao parar scanner:", err));
},
(err) => {}
).catch(err => {
console.error("Erro ao iniciar scanner:", err);
mostrarNotificacao('‚ùå Erro ao acessar c√¢mera!', 'error');
document.getElementById('scanner-modal').classList.remove('active');
});
}
function fecharScanner() {
if (html5QrcodeScanner) {
html5QrcodeScanner.stop().then(() => {
document.getElementById('scanner-modal').classList.remove('active');
}).catch(err => console.error("Erro ao parar scanner:", err));
}
}
document.addEventListener('keydown', (e) => {
if (e.key === 'Escape') fecharScanner();
});
// ========== INICIALIZA√á√ÉO ==========
inicializarDados();
if (sessionStorage.getItem('user_id')) {
document.getElementById('user-name').textContent = sessionStorage.getItem('user_nome');
document.getElementById('screen-login').style.display = 'none';
document.getElementById('screen-vendas').style.display = 'block';
carregarProdutos();
}
document.getElementById('barcode-input').focus();
</script>
</body>
</html>
